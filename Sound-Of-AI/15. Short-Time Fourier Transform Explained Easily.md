### Fourier Transfrom Problem

푸리에 변환을 통하여, 시간 도메인에서 주파수 도메인으로 변경하는게 가능해졌으나, 해당 주파수가 언제 나오는지는 모른다는 문제가 발생했다.

### STFT intuition

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/88ae8f38-c4fb-446e-b43a-6dc722438ccf)

Short-Time Fourier Transform은 말 그대로 전체구간에 대해서가 아닌, 짧은 구간 즉 하나의 프레임에 대해서 푸리에 변환을 진행하는 것이다. 

### Windowing

원본 신호에다가 윈도잉 함수를 적용한다,

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/b15e0d98-0668-42ef-89e0-eb394e3a0e9d)

주로 윈도우 사이즈와, 프레임 사이즈는 동일하다. 

### Overlapping frames

저번에 배웠던 프레임에 대해서, 다음 프레임 구간을 지정할 때, 이전 구간과 겹치게 하여 구간을 지정할 수 있다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/bc3247bd-e052-4233-a678-df320193581e)

이전 프레임의 처음 시작과, 그 다음 프레임의 처음 시작 간의 거리를 hop size라고 부른다. 

### From DFT to STFT

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/d002b995-6ddc-4701-b245-be223083ca7d)

이전에는 전체 원본 이산 신호에 대해서 푸리에변환을 진행했을 때는, 샘플 수의 개수에 대해, 각 지점의 값을 더해서 복소 푸리에계수를 구한 다음, 이를 통해 크기와 / 위상을 알아냈다. 

그러나 Short-time fourier transform에 대해서는, 시간과 프레임의 간의 hope size도 고려해야한다. 

여기서 시간의 변수는 m으로 나타낸다

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/94153520-ea91-4081-916f-8764a9c04061)

위의 사진을 보면, 첫 번째의 윈도잉은 m=1일때, 세 번째의 윈도잉은 m=3일 때 이다.

기간을 지정하기 위해서 mH를 더해주는 이유는 , 현재 프레임의 시작 샘플이기 때문이다. (?)

### Ouputs

**DFT**

- 각 주파수 구성요소에 대해 N개의 푸리에 계수를 얻는다.
- 이산 푸리에 변환을 사용하여 신호를 주파수 도메인으로 변환한 후 얻게 되는 벡터 ( # frequency bins)

**STFT**

- STFT를 사용하여 신호를 주파수 도메인으로 변환한 얻게 되는 행렬 ( # frequency bins, # frames)
- 주파수 구성요소에 대해 하나의 푸리에 계수를 얻는다.

frequency bins

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/5c84d478-dd1f-466d-9463-196b742bc1f1)

프레임의 개수는 , (샘플의 개수 - 프레임의 사이즈 ) / hopsize +1의 연산을 통해 구할 수 있다.

그리고 특정 주파수의 범위는 프레임 사이즈 /2 +1 를 해주면 구할 수 있다. 

→ 이는 푸리에 변환의 대칭성과 관련이 있는데, 이러한 대칭성 때문에 STFT에서 양쪽 대칭성의 주파수 바이너리 수를 절반으로 줄이고 0 Hz와 Nyquist 주파수(샘플링 주파수의 반)를 포함하여 1을 더합니다. 

### Example STFT output

- Signal= 10k samples (10000개의 샘플)
- Frame size = 1000
- Hop size = 500

frames = (10000-1000)/500 + 1 = 19 → 신호가 분할될 19개의 프레임이 존재 

frequency bins = 1000/2 +1 → 501 → (0,sampling rate/2)

STFT → (501,19)

### STFT parameters

- 프레임 사이즈 ( 512 , 1024,2048, 4096 등의 값으로, 이는 2의 거듭제곱으로 구성된다)
- Hop size ( 256,512,1024,2048,4096 등의 값으로 0.5K, 0.25K, 등의 값을 가진다)
- Windowing function (Hann window …. ?)

### Time / frequency trade off

STFT를 진행할 때, 시간 해상도와 주파수 해상도는 반비례 관계에 있다.

프레임 사이즈를 키우면 ( 한 프레임 크기에서 더 많은 샘플을 취하면) 출력으로 더 많은 수의 주파수 빈을 가지게 되지만, 더 많은 샘플을 고려하고 있기 때문에 시간 해상도가 나빠진다. 

### Visualising sound

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/5bd6efb0-ecc6-424c-a532-1eaebbe3e6c0)

신호에 대해서 시각화가 가능하다. 

