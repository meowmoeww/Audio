### Psychoacoustic experiment

- 1st sample : C2 - C4 → (65 ` 262HZ)
- 2st sample : G6 - A6 → ( 1568 -1760Hz)

첫번째 샘플과 두번째 샘플에서 각 노트간의 주파수 차이는 200Hz이지만, 듣기에는 그렇게 느껴지지 않는다. 

“Humans perceive frequency logarithmically” : 주파수는 바닐라 스펙트럼에서 선형으로 설명되는데, 인간이 인식하는 방식은 선형이 아니기 때문이다. 

### 이상적인 오디오 특징

- 시간 - 주파수의 표현이다
- 인간이 듣고 이해하기 편한 방식으로 진폭을 표현
- 인간이 듣고 이해하기 편한 방식으로 주파수를 표현

→ 따라서 지각적으로 정보를 제공하기 위하여, 스펙트로그램과 멜의 개념이 합친 Mel spectrograms이 나오게 된다 

### Mel-scale

: 멜 스케일(Mel scale)은 주파수를 로그 스케일로 변환한 것으로, 인간의 청취 특성을 반영하기 위해 사용된다. 이는 인간이 높은 주파수에 덜 민감하고 낮은 주파수에 민감하다는 사실을 반영한 것이. 따라서 멜 스케일은 주파수를 높은 부분에서는 더 큰 간격으로, 낮은 부분에서는 작은 간격으로 표현하여 인간의 청각 특성을 잘 반영합니다.

- 로그 스케일의 값을 사용한다
- 1000 HZ 는 1000 Mel을 의미한다. (읭 아닌디 ?????)
- 주파수 간의 멜 단위가 동일한 간격을 가지고 있다면 이, 같은 “지각적인” 거리를 가지고 있다고 여긴다.

주파수가 주어졌을 때 Mel을 구하거나, Mel이 주어졌을 때 주파수를 구하기 위해서는 아래의 식을 이용하면 된다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/f9031307-c9bd-4023-be34-c6d3e93db895)

### Recipe to extract Mel spectrogram

1. STFT를 추출한다 
2. 진폭을 DBs로 변환한다.
3. 해담 스펙트로그램의 주파수를 Mel scale의 표현으로 변환한다. 

### How many mel bands?

40 , 60 , 90, 128 등 문제에 따라 달라진다. 

### convert frequencies to Mel scale

1. 멜 밴드들의 갯수를 정한다.
2. mel filter banks를 구축한다
3. 스펙트로그램에 mel filter를 적용한다. 

### Mel filter banks

1. 가장 낮은 / 가장 높은 주파수를 멜로 변환한다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/3408058a-ec66-465e-9da6-97fab780aec2)

2. 주파수 영역을 일정한 간격으로 나누기 (왼쪽 초록색 점은 가장 낮은 주파수, 오른쪽 초록색 점은 가장 높은 주파수)
 이는 주파수 분석을 위해 필요한 밴드의 개수와 그 간격을 결정하는 중요한 단계 중 하나이다

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/37a4c364-42a8-4e84-bbf6-f09849d98f52)

3. 멜 스케일 상의 주파수 포인트를 다시 헤르츠로 변환을 해줘야하며, 이를 통해 멜 필터 뱅크를 통해 얻은 주파수 정보를 실제 주파수 영역으로 되돌린다.
   
![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/fac7b471-7238-464b-8dee-1fd68df0748e)

4. 이산 신호를 사용하고 있기 때문에, 가장 가까운 주파수 빈의 값으로 올림을 해줘야한다.
5. 주파수 영역을 일정한 간격으로 나누어 각 구간에 대응하는 필터를 생성하는 것을 말합니다. 이는 주파수 영역에서 특정 주파수 대역의 신호를 추출하거나 강조하는 데 사용됩니다. 이산 신호를 다룰 때에는 주파수 영역을 이산화하여 각 구간을 삼각형 모양의 필터로 표현하는 것이 일반적이다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/26e57295-98d1-4b20-98fe-86737a10e9d3)

### Mel filter bank’s shape

(#bands, framesize/2 +1)

### Convert frequencies to Mel scale

앞에서 말한 3번 “ 스펙트로 그래에 멜 필터를 적용한다” 과연 이걸 어떻게 스펙트로그램에 적용할까?

### Applying mel filter banks to spectrogram

멜 필터 아와 스펙트로그램은 아래와 같은 사이즈를 가지고 있다.

M = (#bands, framsize/2 +1) 

Y = (framesize /2 +1 , # frames)

M 행렬의 열수와, Y 행렬의 행수가 동일하기 때문에, 둘 사이에 행렬곱셉을 진행하면 이는 멜필터를 스펙트로그램에 적용하는 것이다. 

Mel spectrogram = MY

(#bands , # frames) 그럼 둘의 곱의 연산의 결과는 다음과 같은 사이즈를 가지게 된다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/e25e8a4d-0054-40b7-bcab-50e0eb3b8e77)

멜 스펙트로그램은 x축이 시간, y축이 주파수이다. 다만 이 주파수는 스펙트로그램에 사용되는 주파수가 아닌, 멜 필터를 적용한 주파수의 결과이다. 

### Mel spectrogram applictions

많은 AI 오디오 개발에 멜 스펙트로그램이 사용된다

- audio classification
- automatic mood recognition
- Music genre classification
- Music instrument classification
