### 이전 시간에 다룬 ML을 위한 오디오 프로세싱에는 다음과 같은 세가지 방식이 있다.

1) Time-domain features

2) Frequency-domain features

3) Time-frequency domain features

## Time-domain feature pipeline

시간 도메인에서 time-domain feature를 얻어내기 위해서는, 아날로그 사운드를 샘플링하고 양자화 해야한다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/6cee1dd1-6ca2-476c-b97d-79bc99b51157)

### Frames

샘플링하는 과정에서 프레임이라는 개념이 나오는데 이는 인식이 가능한 오디오 청크이다. 

- 하나의 샘플이 44.1KHz의 주파수를 가지고 있을 때, 그 샘플의 지속시간은 주파수의 역수인 0.0227ms와 같으며 이는 인간의 청각에 대한 시간분해능력의 임계값인 10ms보다 작다.
- 프레임이 샘플을 가질 때, 2의 제곱만큼 가지고 있으면 프로세스 속도가 높아진다.

→ FFT 알고리즘은 주로 분할 정복(divide and conquer) 방식을 사용하여 신호를 재귀적으로 분석합니다. 입력 신호를 반으로 나누고, 다시 각각의 반씩을 분석하고, 이를 반복하여 주파수 영역으로 변환합니다. 이러한 재귀적인 분할 과정에서 입력 신호의 길이가 2의 거듭제곱 수일 때 가장 효율적으로 동작합니다.

- 프레임이 가지는 일반적인 값들은 256에서 8192 사이이다.

df = 프레임 크기 (K) / 샘플링크기 (Sr) 

ex) 44100의 샘플을 가지게 만든 샘플링 크기로 512의 프레임 크기를 나누면 11.6ms가 나오게 된다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/cc73322d-2998-4047-9bc2-b23137737e15)

그런 다음 서로 다른 각각의 프레임의 시간 영역 특성을 계산하는 feature computation을 거친 후, 전체소리에 대해 무엇이든 단일 종류의 유사한 특징 벡터를 얻는 aggregation을 거치면 feature vaule/vector/matrix를 얻을 수 있다. 

## Frequency-domain feature pipiline

time domain에서 이루어진 프레이밍 과정까지는 동일하다.

## From time to frequency domain
![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/952f9b6d-e01a-4855-a015-58101829b85c)

그러나 여기서는 시간의 영역에서 주파수의 영역으로 변경시켜줘야한다. 

### spectral leackage

- 스펙트럼 누출은 신호를 처리할 때 발생한다 이는, 주파수 도메인 변환을 적용할 때, 주어진 오디오 신호의 길이가 정확히 정수의 배수의 길이가 아니기 때문에  주파수 분석 결과가 왜곡되어 나타나는 현상이다.
- 시간 도메인에서 신호를 잘라낼 때, 신호들의 끝점이 부드럽게 연결되어 있지 않으면 주파수 도메인 변환을 적용할 때 주파수 분석 결과가 왜곡될 수 있다.
- 신호 처리 중에 발생하는 불연속성(discontinuities)이 원래의 신호에는 없는 고주파 성분으로 나타날 수 있다는 것을 의미한다. 아래 사진의 빨간색 박스를 보면, 원래 신호에는 존재하지 않지만 시간 표현을 주파수 표현으로 변경할 때 나타난 값이다

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/2ed77452-0999-4c05-9ff0-0dd8398794a0)

### windowing

frequency-domain feature pipeline에서는 framing 다음에 windowing을 진행해준다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/f22a23d5-5c08-4793-ac94-28935976eaa4)

- 주파수 도메인 특징을 추출하기 전에 각 프레임에 대해 윈도우 함수를 적용하여 주변 데이터의 영향을 줄이는 것을 의미한다.
- 프레임의 끝점에 있는 샘플을 제거한다 → 시작과 끝에서 발생할 수 있는 불연속성이나 부드럽지 않은 절단 등의 문제를 완화할 수 있다.
- 윈도우 함수를 적용하면 일정한 주기를 갖는 주기적인 신호를 만들 수 있다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/82c2b059-f0a7-4032-b59b-7ccd653d173c)

원본 신호에 각 대응 샘플의 hand window를 곱해주는 것이다.

### 또 다른 문제 
![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/9e05ca03-0e2c-4438-ae6b-beca543cde30)

Framing을 진행하다보면, 다음과 같이 분홍색 박스에 들어있는 신호들을 잃어버릴 수도 있다.

이를 잃어버리지 않기 위해서는 프레임을 겹치는 방법이 존재한다

### Non-overlapping frames
![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/ec98971b-015a-45ef-9763-2f724c1a5a7b)

위의 사진과 같이 경우에는 겹치지 않게 프레임을 가진 것이다.

### Overlapping frames 
![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/4721c19a-98d8-42c3-b0d2-509cc15ee8af)

오버래핑된 프레임들은 위의 사진과 같이 다음 프레임을 가질 때 전의 프레임에 겹치게끔 프레임을 설정하는 것이다. 

하나의 프레임의 크기는 Frame size라고 한다.

빨간색 박스의 왼쪽 선과, 초록색 박스의 왼쪽 선까지의 거리를 hop length라고 하며, 이는 연속적인 프레임 사이의 거리를 의미한다.

![image](https://github.com/meowmoeww/Sound-Of-AI/assets/89447043/f5d50db1-0b50-4519-bb66-f53370bd49ba)

Windowing까지 진행되고 나면, 스펙트럼 누출이 최소화된 스펙트럼을 가지고 시간 영역 특징 파이프라인에서 사용한 것과 동일한 과정으로 진행이 된다.

