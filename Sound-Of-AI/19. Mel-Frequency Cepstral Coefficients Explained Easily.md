### Mel-Frequency Cepstral Coefficients (MFCC)

멜 스펙트로그램과 유사한 개념을 기반으로 하며, 멜 스케일을 사용하는 것이 그 핵심이다.

![image](https://github.com/meowmoeww/Audio/assets/89447043/fc94c048-1738-42ad-9d3a-345794722120)

### An historical note on Cepstrum

- 1960년대에 세프스트럼이 개발될 당시에는 지진 신호의 반향을 연구하는 과정에서 발전되었다
    
    세프스트럼 분석은 시간 도메인의 신호를 주파수 도메인으로 변환한 뒤, 이를 다시 로그 스펙트럼으로 변환하고, 마지막으로 이 로그 스펙트럼을 다시 시간 도메인으로 변환하는 과정을 통해 계산된다. 
    
- 1970년대에는 세프스트럼은 특정한 상황에서 음성을 인식하거나 식별하는 데 사용되는 주요 오디오 특성에서 사용되었다.
- 2000년대에는 음악 프로세싱에서 사용되었다.

### Computing the cepstrum

![image](https://github.com/meowmoeww/Audio/assets/89447043/967ca644-7f0d-43c4-9010-542f316ef78b)

- x(t)는 시간영역의 신호로서 파형이다.
    
![image](https://github.com/meowmoeww/Audio/assets/89447043/8d0253a4-982a-46bc-b0d9-c22e8ff81533)
    
- 파형에 이산 푸리에 변환을 통해 스펙트럼으로 변하게 되고 시간 영역에서 주파수 도메인으로 넘어왔다. 이는 신호의 각 주파수 구성 요소와 그 진폭을 나타낸다.
    
![image](https://github.com/meowmoeww/Audio/assets/89447043/1583f268-f456-4b1f-ade6-0d01cc5b2dc9)
    
- 로그 진폭 스펙트롬을 얻는다.

변환된 스펙트럼의 진폭에 로그를 적용한다. 이 과정은 신호의 다이내믹 레인지를 줄이고, 인간의 귀가 소리의 강도를 인지하는 방식에 더 가깝게 해준다. ( y축에 데시벨을 얻고, x축에서는 주파수를 얻는다. )

![image](https://github.com/meowmoeww/Audio/assets/89447043/17c8a948-3e2c-4f24-900c-8b5c6cf3f2f9)

- 이에 대해 역푸리에 적용해 다시 시간영역으로 변환한다. 결과적으로 얻어지는 건 원래의 시간 영역 신호 (x(t))가 아니라 Cepstrum이다. Cepstrum은 시간 영역에 있지만 시간과 관련한 변수가 아니라 주파수와 관련된 새로운 형태의 신호이다.

### Visualising the cepstrum

![image](https://github.com/meowmoeww/Audio/assets/89447043/977d1861-4b74-411b-9ca2-6aa411c01784)

왼쪽은 원본 신호이며 40초 가량의 짧은 오디오이다.

이를 이산 푸리에 변환을 하면 오른쪽의 사진과 같고 시간 도메인에서 주파수 도메인으로 넘어온 것을 확인할 수 있다. 이는 각 주파수의 구성요소가 원본 신호에 얼마나 많이 존재하는지(power)를 알려준다. 

![image](https://github.com/meowmoeww/Audio/assets/89447043/5ecf3552-8218-4312-a3c8-c219f6ed5cdc)

이산 푸리에 변환을 통해 얻은 power spectrum의 power값에 log를 취한다. 이는 큰 값을 줄이고 작은 값을 상대적으로 늘려, 다이나믹 레인지를 줄이고 세부적인 차이를 더 잘 드러나게 한다.

우측의 magnitude는  로그 변환 후의 값으로, 주로 데시벨(dB) 단위를 사용한다. 

![image](https://github.com/meowmoeww/Audio/assets/89447043/aa3c6a03-b610-4b7d-b1d5-b1c17d09a907)

그런 다음 log power spectrum에 역 이산 푸리에 변환을 적용하여 cepstrum을 얻는다. 

Cepstrum에서 x축은 Quefrency로 이는 주파수 도메인과 유사한 것이지만, 실제로는 주파수 도메인은 아니고 신호 내에서 주파수의 변화를 관찰한다.

이러한 cepstrum은 스펙트럼의 주파수 성분들이 서로 어떤 구조를 가지고 있는지를 분석하기 위한 방법 중 하나이다. 

### Speech generation

1. Glottal pulses:  이것은 성대가 열리고 닫히는 과정에서 발생하는 주기적인 진동을 의미한다. 이 진동은 음성 신호의 기본적인 구성 요소로, 모든 음성 신호에는 Glottal pulses 에서 파생된 주파수 성분이 포함된다.
2. Vocal tract: 성대에서 발생한 진동이 목소리 트랙을 통과할 때, 목구멍, 구강, 코 등의 공간을 거치면서 음성 신호가 형성된다. 목소리 트랙의 형태와 크기에 따라 특정 주파수가 강조되거나 약화되어 우리가 듣는 음성의 독특한 특성이 만들어진다.
3. Speech signal: Glottal pulses와 Vocal tract의 상호작용 결과로 생성되는 음성 신호는 복잡한 주파수 구성을 가지고 있다. 이 신호는 시간 영역에서 파형으로 나타나며, 주파수 영역에서의 분석을 통해 Glottal pulses와 Vocal tract에서 파생된 정보를 추출할 수 있다. 

따라서 cepstrum은 이러한 Glottal pulses와 Vocal tract에 의해 생성되는 주파수 성분을 분석하고 추출하는 데 사용되며, 이를 통해 음성 신호의 특징을 파악하고 처리할 수 있다.

### Understanding the cepstrum

![image](https://github.com/meowmoeww/Audio/assets/89447043/20198a4a-4541-4e83-aacb-491174b0653d)

1. Log-spectrum과 Speech: Log-spectrum은 음성 신호의 주파수 성분을 로그 스케일로 표현한다. 이는 동적 범위를 줄여 주파수 성분의 변화를 더 잘 드러내며, 음성 신호의 주파수 특성을 더 세밀하게 분석할 수 있게 한다. 
2. Spectral envelope과 Vocal tract frequency response: Vocal tract frequency response는 음성이 생성 과정에서 성대와 성도의 변환에 따라서 어떻게 주파수가 변하는 지를 나타내는 것이다. 이를 설명하기 위해서는 Formants의 개념이 필요한데 이는 성도의 공명 특성에 의해 생성되는 주파수 대역으로, 음성의 특정한 음질을 결정짓는 중요한 요소로써 소리의 identity를 운반한다고 할 수 있다. 
    
    spectral envelope는 음성 신호의 전체적인 주파수 특성을 나타내며 이는 Vocal tract frequency response에 의해 결정된다. 이는 다양한 포만트의 위치와 강도를 포함하여, 음성 신호의 주파수 특성을 총체적으로 나타낸다.
    

3. Spectral detail과 Glottal pulse: Spectral detail은 음성 신호의 고주파 성분이나 작은 변동을 포함한 세부 주파수 특성을 나타낸다. 이는 주로 성대의 진동인 Glottal pulse과 관련이 있다. Glottal pulse는 성대가 열리고 닫히면서 발생하는 주기적인 pulse로 성도를 통과하면서 다양한 주파수 성분으로 변화해 음성 신호를 형성한다. 

### Formalising speech

- 시간 영역에서의 음성 신호 생성 과정
    
    x(t) = e(t) * h(t) 
    
    speech signal = glottal pulse * vocal track frequency response
    

음성 신호는 Glottal pulse와  Vocal tract frequency response의 합성으로 만들어진다. 이는 음성 생성 과정에서 성대의 진동이 성도의 구조를 통해 필터링되어 최종적인 음성 신호가 형성된다는 것을 의의하고 여기서 합성은 신호가 어떤 시스템을 통과할 때 그 시스템의 특성에 따라 신호가 어떻게 변형되는지를 나타내는 개념이다.

- 주파수 영역에서의 음성 신호 생성 과정
    
    X(t) = E(t) * H(t)
    
    cepstrum = glottal pulse spectrum * vocal track frequency response spectrum
    

### Formalising speech

![image](https://github.com/meowmoeww/Audio/assets/89447043/f4328501-1e34-40d9-a78e-4f3f9a4b058c)

로그의 성질을 사용하여, 곱셈이었던 신호의 구성 요소들을 덧셈으로 변환한다.

이러한 변환을 통해, glottal pulse spectrum 와 vocal track frequency response spectrum (주파수 영역)을 더욱 세밀하게 분리하여 연구할 수 있다

![image](https://github.com/meowmoeww/Audio/assets/89447043/573dc687-4504-4910-8509-0bf1afa64ded)

### 목표 : 요소들을 분리

![image](https://github.com/meowmoeww/Audio/assets/89447043/c93fd87d-8c94-4e02-8b07-4b563dc6fbf3)

음성신호가 아래와 같이 분리 되었을 때 , 왼쪽의 그림이 Vocal tract frequency이고 오른쪽이 Glottal pulse이다.

### Separating components

![image](https://github.com/meowmoeww/Audio/assets/89447043/a73e9c48-bb76-49e9-a7c1-7fb5a964da22)

log(E(t))와 log(H(t))에 역이산 푸리에 변환을 적용하여 quefrency의 값을 얻는다. 

위의 그림에서 Vocal Tract Frequency Response는 4hz 값을 가지고 glottal pulse는 100hz의 값을 가지는데 이는 주파수 성분이 얼마나 반복되는 지를 의미한다.

### Computing Mel-Frequency Cepstral Coefficients

![image](https://github.com/meowmoeww/Audio/assets/89447043/2ffc2854-cba5-4eda-87da-85130665fca7)

위에서는 cepstrum을 구하는 방법에 대해서 설명했는데 여기서 좀 더 발전시킨 개념이 MFCC이다.

이는 waveform에 푸리에 변환을 적용시킨 다음 log 값을 취하고 여기에 mel-scaling을 적용해서 얻은 mel spectrogram에  discrete cosine transform을 적용해서 계수를 추출해내는 방식이다. 이 계수들은 음성 신호의 주요 특질을 나타내며, 특히 음성의 포만트와 같은 중요한 음향적 특성을 포착하는 데 매우 효과적이다.

### why discrete cosine transform

- DCT가 주파수 도메인에서 시간 도메인으로 신호를 변환하는 데 사용되는 방법 중 하나로, 특히 주파수 영역에서의 정보를 더 효과적으로 표현하기 위한 방법이다.
- DCT를 수행할 때 얻는 계수들이 실수를 가진다. DCT는 주로 실수값을 다루는데 효과적이며, 이는 실제 음성이나 영상 데이터의 특성을 잘 반영하고 처리할 수 있다.
- DCT는 멜 스펙트럼에서 다른 Mel 밴드 간의 에너지 상관관계를 줄이는 데 도움을 준다.
- DCT를 사용하면 주파수 스펙트럼을 나타내기 위해 사용되는 차원의 수를 줄일 수 있다.

### How many coefficients?

- MFCC에서는 첫 번째 12개 또는 13개의 계수를 사용한다.
- 첫번째 계수는 주로 음성 신호의 중요한 정보를 대부분 담고 있다. 9포만트(formants)와 스펙트럴 엔벨로프(spectral envelope)와 같은 특성)
- MFCC의 변화량(Δ MFCCs)과 변화량의 변화량(ΔΔ MFCCs)도 중요한 정보를 제공한다.. 이러한 변화량은 시간에 따른 MFCC의 변화를 측정하여, 음성 신호의 동적 특성을 잡아내는 데 사용된다.
- 각 프레임마다 기본 MFCC 12~13개, 그리고 각각의 변화량(Δ)과 변화량의 변화량(ΔΔ)을 포함하여 총 39개의 계수를 사용한다.

### Visualising MFCC

![image](https://github.com/meowmoeww/Audio/assets/89447043/a08bd5ac-0e86-4b9a-b0fa-8961713899f9)
